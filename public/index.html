<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Tangram</title>
    <!-- icon -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css"
      type="text/css"
      media="screen"
      charset="utf-8"
    />
    <!-- alert -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <script src="sweetalert2.all.min.js"></script>
    <!-- styles -->
    <link
      rel="stylesheet"
      href="css/style.css"
      type="text/css"
      media="screen"
      charset="utf-8"
    />
    <!-- js -->

    <!-- <script src="js/instructions.js"></script> -->
    <script src="js/index.js"></script>

    <!-- <script src="firebase_config.js"></script> -->
    <!-- <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-firestore.js"></script>   -->
  </head>

  <body>
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- <script src="/__/firebase/8.3.1/firebase-app.js"></script> -->

    <!-- Add Firebase products that you want to use -->
    <!-- <script src="/__/firebase/8.3.1/firebase-auth.js"></script>
    <script src="/__/firebase/8.3.1/firebase-firestore.js"></script>
    <script src="/__/firebase/8.3.1/firebase-storage.js"></script> -->

    <!-- <div class="title">
      <h1 class="text-center">Tangrams</h1>
    </div> -->

    <div class="left">
      <!-- <div class="sidebar"> -->
      <button class="button submit" onclick="showTutorial()">
        <!-- <span class="octicon octicon-question"></span> -->
        Instructions
      </button>

      <!-- <div id="firebaseui-auth-container"></div> -->

      <!-- </div> -->
      <!-- <div class="instructions">
        <p id="instructions"></p>
      </div> -->
      <div class="image">
        <object id="tangramObj" data="" type="image/svg+xml"></object>
      </div>
    </div>
    <div class="right">
      <div class="output-outer">
        <p>Annotation:</p>
        <div class="output" id="output">
          <ol id="list"></ol>
        </div>
      </div>
      <button id="next" class="button next" disabled>Next</button>
      <div class="annotation">
        <input
          id="annotate"
          class="textbox"
          type="text"
          onkeyup="stoppedTyping()"
          disabled
        />
        <button id="submit" class="button submit" disabled>Submit</button>
        <button id="duplicate" class="button duplicate">Duplicate</button>
      </div>
    </div>

    <!-- <script>
      document.getElementById("instructions").innerHTML = instructions;
    </script> -->

    <script>
      function stoppedTyping() {
        var text = document.getElementById("annotate");
        var bt = document.getElementById("submit");
        var dup = document.getElementById("duplicate");
        if (text.value.length === 0 || selection.every((v) => v === false)) {
          // empty input or no selection
          bt.disabled = true;
          dup.disabled = true;
          bt.setAttribute("class", "button submit");
          bt.innerText = "Submit";
          dup.setAttribute("style", "visibility: hidden");
        } else {
          bt.disabled = false;
          dup.disabled = false;
          //duplicate
          if (ann_to_idx[text.value]) {
            bt.setAttribute("class", "button add");
            bt.innerText = "Add to Group";
            // dup.setAttribute("style", "visibility: visible");
          } else {
            //new annotation
            bt.setAttribute("class", "button submit");
            bt.innerText = "Submit";
            dup.setAttribute("style", "visibility: hidden");
          }
        }
      }

      // remove annotation
      function remove(ann, id) {
        var list = document.getElementById("list");
        var item = document.getElementById(id);
        list.removeChild(item);
        //lookup id(annotation) to pieces
        const pieces = ann_to_idx[ann];
        for (var i = 0; i < pieces.length; i++) {
          //remove piece annotation
          const piece_id = pieces[i];
          annotated[piece_id] = "";
          var a = document.getElementById("tangramObj");
          var svgDoc = a.contentDocument;
          var t = svgDoc.getElementById(piece_id);
          // t.setAttribute("fill-opacity", "0.4");
          // t.setAttribute("fill", colors[piece_id]);
          // t.setAttribute("stroke", "white");
          t.setAttribute("fill", "lightgray");
          // reset tracker data
          piece_to_color[piece_id] = "";
        }
        //delete ann_to_idx entry
        delete ann_to_idx[ann];
        // set final to false in log
        metadata[id]["final"] = false;

        // disable next
        var next = document.getElementById("next");
        next.disabled = true;

        logging();
      }
    </script>

    <!-- Firebase -->
    <!-- <script>
      var firebaseConfig = {
        apiKey: "AIzaSyDVFNgeaaWeBSNdAXoieOHmeoEcMnST6Xc",
        authDomain: "tangram-c997f.firebaseapp.com",
        projectId: "tangram-c997f",
        storageBucket: "tangram-c997f.appspot.com",
        messagingSenderId: "828079104765",
        appId: "1:828079104765:web:d8c5928395240394e0d494",
      };
      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();
      const storage = firebase.storage();
      var storageRef = storage.ref();
    </script> -->

    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.4.3/firebase-app.js"></script>

    <!-- Add Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/8.4.3/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.4.3/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.4.3/firebase-storage.js"></script>

    <script type="text/javascript">
      var firebaseConfig = {
        apiKey: "AIzaSyDVFNgeaaWeBSNdAXoieOHmeoEcMnST6Xc",
        authDomain: "tangram-c997f.firebaseapp.com",
        projectId: "tangram-c997f",
        storageBucket: "tangram-c997f.appspot.com",
        messagingSenderId: "828079104765",
        appId: "1:828079104765:web:d8c5928395240394e0d494",
      };
      firebase.initializeApp(firebaseConfig);
    </script>

    <script src="https://www.gstatic.com/firebasejs/ui/4.8.0/firebase-ui-auth.js"></script>
    <link
      type="text/css"
      rel="stylesheet"
      href="https://www.gstatic.com/firebasejs/ui/4.8.0/firebase-ui-auth.css"
    />

    <!-- <script type="text/javascript">
      var ui = new firebaseui.auth.AuthUI(firebase.auth());
      var uiConfig = {
        callbacks: {
          signInSuccessWithAuthResult: function (authResult, redirectUrl) {
            // User successfully signed in.
            // Return type determines whether we continue the redirect automatically
            // or whether we leave that to developer to handle.
            console.log(authResult, redirectUrl);
            return false;
          },
          uiShown: function () {
            // The widget is rendered.
            // Hide the loader.
            document.getElementById("loader").style.display = "none";
          },
        },
        // Will use popup for IDP Providers sign-in flow instead of the default, redirect.
        signInFlow: "popup",
        signInSuccessUrl: "<url-to-redirect-to-on-success>",
        signInOptions: [firebase.auth.EmailAuthProvider.PROVIDER_ID],
        // Other config options...
      };
      ui.start("#firebaseui-auth-container", uiConfig);
    </script> -->
    <script type="text/javascript" src="js/db.js"></script>
    <script type="text/javascript" src="js/select.js"></script>
    <script type="text/javascript" src="js/files.js"></script>
  </body>
</html>
